### Инструкция по сборке и запуску приложения
> В этом разделе нужно описать пререквизиты и примеры запуска
Стандартно сделать venv, активировать, поставить депенденси и запустить локальный сервер:
```
python -m venv env
source env/bin/activate
pip install -r requirements.txt
python vulnapp/manage.py runserver
```
И поставить exiftool apt install exiftool.

Тк БД sqlite есть в репо, то миграции делать ненужно.

Чтобы воспользоватся приложением, надо зайти на http://127.0.0.1:8000/. Чтобы зарегистрировать аккаунт можно просто нажать на "Create new post", он перенесет на страницу авторизации автоматически. Тамже и есть кнопка перехода на регистрацию аккаунта.

Далее можно создавать посты которые увидят другие пользователи.

### Proof of Concept
#### XSS
Чтобы стригерить XSS надо просто наажать "Create new post", выбрать какуюнить картинку и в текстовое поле вставить html код. 

```
<script>alert()</script>
```
При заходе на главную страницу код исполнится.

#### IDOR
Создаем собственное сообщение, и открываем devtools вкладку сеть. Удаляем собственное сообщение, и нажимаем на запрос copy as fetch. Через другой аккаунт создаем чужое сообщение которое хотим удалить, либо удалям уже существующее. с дампа БД должны быть мои сообщения, например айди 15.

```
await fetch("http://127.0.0.1:8000/delete/15", {
    "credentials": "include",
    "headers": {
        "User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0",
        "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
        "Accept-Language": "en-US,en;q=0.5",
        "Content-Type": "application/x-www-form-urlencoded",
        "Upgrade-Insecure-Requests": "1",
        "Sec-Fetch-Dest": "document",
        "Sec-Fetch-Mode": "navigate",
        "Sec-Fetch-Site": "same-origin",
        "Sec-Fetch-User": "?1"
    },
    "referrer": "http://127.0.0.1:8000/",
    "method": "POST",
    "mode": "cors"
});
```

В самом интерфейсе я специально оставил функцию убирания кнопки, чтобы это было как настоящий IDOR бекенда.
#### SQLI
Тк использовал ORM для всех запросов, то инъекций нету.
#### OS command injection
Берем любую картинку которую загрузили, нажимаем copy url. И меняем user_uploads на get_exif_data:

127.0.0.1:8000/get_exif_data/cartinka.jpg

Тк используется shell=True, и испльзуется простое прибавление строк, то можно просто:

http://127.0.0.1:8000/get_exif_data/%60id%60

Это например исполнит команду id.
#### Path Traversal
Тк была убрана проверка белого списка БД на пути + путь к файлу берется из параметра запроса:
```
curl http://127.0.0.1:8000/user_uploads/?path=../../../../../etc/passwd
```
то теперь можно 

#### Brute force
Использовал Django-axe он ставит ограничения на скорость попыток по айпи. В джанге встроенная парольная политика очень жесткая, поэтому брутфорс невозможен.

### Дополнительные комментарии
Для простоты проверки на IDOR я выключил CSRF милдлварь.

Дебаг в проде это плохо.